title: 对现有的WOW LUA 组队角本的分析
id: 640
categories:
  - 计算机与 Internet
date: 2005-05-20 01:50:20
tags:
---

<div id="msgcns!9697D6160EFEBC17!119" class="bvMsg">

现在已经有了一个组队的相互操作角本,不过据说只是在美F和欧F可以用,因为需要打魔法的名称,这个CNWOW里面是不同的,也许汉化过之后就可以了,HUHU,我会尽快练个魔法辅助职业测试一下看.

下面是它的代码 下载可以到[http://www.curse-gaming.com/mod.php?addid=463](http://www.curse-gaming.com/mod.php?addid=463)

回头我们慢慢分析,HUHU

<font color="#0000ff">WhisperCast_Version = 2.1</font>

<font color="#0000ff">-- Recode by Sarris of Blackhand, originally by Valconeye
-- Original BestBuff by Gello</font>

<font color="#0000ff">BINDING_HEADER_WHISPERCAST=&quot;WhisperCast&quot;;
BINDING_NAME_WHISPERCAST=&quot;Cast&quot;;
BINDING_NAME_WHISPERCAST_SHOW=&quot;Show/Hide Gui&quot;;</font>

<font color="#0000ff">local CHAT_RED = &quot;|cFFFF0000&quot;
local CHAT_GREEN = &quot;|cFF00FF00&quot;
local CHAT_END = &quot;|r&quot;</font>

<font color="#0000ff">-- main spell queue
WhisperCast = &#123; min=1, next=1, n=0 &#125;;</font>

<font color="#0000ff">-- saved variable
WhisperCast_Profile = &#123;&#125;</font>

<font color="#0000ff">-- loaded with current players spells
WhisperCast_Spells = nil;</font>

<font color="#0000ff">-- unit names of people in my current group/raid
WhisperCast_Group = &#123;&#125;</font>

<font color="#0000ff">local WhisperCast_defaultProfile = &#123;
    ['profileversion'] = 1,
    ['enable'] = 1,
    ['minimize'] = 0,
    ['failures'] = 4, -- failures before a spell is dequeued
    ['failuregracetime'] = 1, -- second between counted failures
    ['grouponly'] = 1,
    ['restrictcombat'] = 1,
    ['mainalpha'] = 1,
    ['backalpha'] = 0.6,
    ['match'] = &quot;start&quot;,
&#125;;</font>

<font color="#0000ff">WhisperCast_SpellLibrary = &#123;
    -- Priest Buffs
    PRIEST = &#123;
        [&quot;Power Word: Fortitude&quot;] = &#123;
            trigger = &#123; &quot;fort&quot;, &quot;fortitude&quot;, &quot;stam&quot;, &quot;stamina&quot; &#125;,
            level = 1,
            rank = &#123; 1, 12, 24, 36, 48, 60 &#125; &#125;,
        [&quot;Prayer of Fortitude&quot;] = &#123;
            trigger = &#123; &quot;group fort&quot;, &quot;group fortitude&quot;, &quot;group stam&quot;, &quot;group stamina&quot; &#125;,
            level = 48,
            rank = &#123; 48, 60 &#125; &#125;,
        [&quot;Shadow Protection&quot;] = &#123;
            trigger = &#123; &quot;shadow&quot; &#125;,
            level = 30,
            rank = &#123; 30, 42, 56 &#125; &#125;,
        [&quot;Divine Spirit&quot;] = &#123;
            trigger = &#123; &quot;spirit&quot; &#125;,
            level = 40,
            rank = &#123; 40, 42, 54 &#125; &#125;,
        [&quot;Power Word: Shield&quot;] = &#123;
            trigger = &#123; &quot;shield&quot; &#125;,
            level = 6,
            rank = &#123; 6, 12, 18, 24, 30, 36, 42, 48, 54, 60 &#125;,
            combat = true &#125;,
        [&quot;Dispel Magic&quot;] = &#123;
            trigger = &#123; &quot;dispel&quot; &#125;,
            level = 18,
            rank = &#123; 18 --[[only use rank 1, 36]] &#125;,
            combat = true &#125;,
        [&quot;Abolish Disease&quot;] = &#123;
            trigger = &#123; &quot;disease&quot; &#125;,
            level = 24,
            combat = true &#125;,
        [&quot;Fear Ward&quot;] = &#123;
            trigger = &#123; &quot;fear&quot;, &quot;ward&quot; &#125;,
            level = 20,
            combat = true &#125;,
    &#125;,
    -- Mage Buff
    MAGE = &#123;
        [&quot;Arcane Intellect&quot;] = &#123;
            trigger = &#123; &quot;ai&quot;, &quot;int&quot; &#125;,
            level = 1,
            rank = &#123; 1, 14, 28, 42, 56 &#125; &#125;,
        [&quot;Arcane Brilliance&quot;] = &#123;
            trigger = &#123; &quot;group ai&quot;, &quot;group int&quot;, &quot;brilliance&quot; &#125;,
            level = 46,
            rank = &#123; 46 &#125; &#125;,
        [&quot;Dampen Magic&quot;] = &#123;
            trigger = &#123; &quot;dampen&quot; &#125;,
            level = 12,
            rank = &#123; 12, 24, 36, 48, 60 &#125; &#125;,
        [&quot;Amplify Magic&quot;] = &#123;
            trigger = &#123; &quot;amplify&quot; &#125;,
            level = 18,
            rank = &#123; 18, 30, 42, 54 &#125; &#125;,
        [&quot;Remove Lesser Curse&quot;] = &#123;
            trigger = &#123; &quot;curse&quot; &#125;,
            level =  16,
            combat = true &#125;,
    &#125;,
    -- Druid buffs
    DRUID = &#123;
        [&quot;Mark of the Wild&quot;] = &#123;
            trigger = &#123; &quot;mark&quot;, &quot;motw&quot; &#125;,
            level = 1,
            rank = &#123; 1, 10, 20, 30, 40, 50, 60 &#125; &#125;,
        [&quot;Gift of the Wild&quot;] = &#123;
            trigger = &#123; &quot;gift&quot;, &quot;group mark&quot;, &quot;gotw&quot; &#125;,
            level = 50,
            rank = &#123; 50, 60 &#125; &#125;,
        [&quot;Thorns&quot;] = &#123;
            trigger = &#123; &quot;thorns&quot; &#125;,
            level = 6,
            rank = &#123; 6, 14, 24, 34, 44, 54 &#125; &#125;,
        [&quot;Remove Curse&quot;] = &#123;
            trigger = &#123; &quot;curse&quot; &#125;,
            level = 22,
            combat = true &#125;,
        [&quot;Abolish Poison&quot;] = &#123;
            trigger = &#123; &quot;disease&quot; &#125;,
            level = 26,
            combat = true &#125;,
    &#125;,
    -- Paladin buffs
    PALADIN = &#123;
        [&quot;Blessing of Might&quot;] = &#123;
            trigger = &#123; &quot;might&quot; &#125;,
            level = 4,
            rank = &#123; 4, 12, 22, 32, 42, 52 &#125; &#125;,
        [&quot;Blessing of Wisdom&quot;] = &#123;
            trigger = &#123; &quot;wisdom&quot; &#125;,
            level = 14,
            rank = &#123; 14, 24, 34, 44, 54 &#125;,
            combat = true &#125;,
        [&quot;Blessing of Freedom&quot;] = &#123;
            trigger = &#123; &quot;freedom&quot; &#125;,
            level = 18 &#125;,
        [&quot;Blessing of Light&quot;] = &#123;
            trigger = &#123; &quot;light&quot; &#125;,
            level = 40,
            rank = &#123; 40, 50, 60 &#125; &#125;,
        [&quot;Blessing of Sacrifice&quot;] = &#123;
            trigger = &#123; &quot;sacrifice&quot; &#125;,
            level = 46,
            rank = &#123; 46, 54 &#125; &#125;,
        [&quot;Blessing of Kings&quot;] = &#123;
            trigger = &#123; &quot;kings&quot; &#125;,
            level = 40 &#125;,
        [&quot;Blessing of Salvation&quot;] = &#123;
            trigger = &#123; &quot;salvation&quot; &#125;,
            level = 26 &#125;,
        [&quot;Blessing of Sanctuary&quot;] = &#123;
            trigger = &#123; &quot;sanctuary&quot; &#125;,
            level = 10,
            rank = &#123; 10, 30, 40, 50, 60 &#125; &#125;,
        [&quot;Cleanse&quot;] = &#123;
            trigger = &#123; &quot;cleanse&quot;, &quot;dispel&quot; &#125;,
            level = 32,
            combat = true &#125;,
        [&quot;Purify&quot;] = &#123;
            trigger = &#123; &quot;purify&quot;, &quot;poison&quot;, &quot;disease&quot; &#125;,
            level = 18,
            combat = true &#125;,
    &#125;,
    SHAMAN = &#123;
        [&quot;Cure Poison&quot;] = &#123;
            trigger = &#123; &quot;poison&quot; &#125;,
            level = &#123; 26 &#125;,
            combat = true &#125;,
        [&quot;Cure Disease&quot;] = &#123;
            trigger = &#123; &quot;disease&quot; &#125;,
            level = &#123; 40 &#125;,
            combat = true &#125;,
    &#125;,
&#125;;</font>

<font color="#0000ff">-- chat frame where queue messages go
local WhisperCast_messages = DEFAULT_CHAT_FRAME;</font>

<font color="#0000ff">-- keep track of if we are in combat
local WhisperCast_playerInCombat = false</font>

<font color="#0000ff">local function WhisperCast_getQueueTextColor(cast)
    if ( WhisperCast_Profile.restrictcombat == 1 and 
         WhisperCast_playerInCombat and
         not WhisperCast_Spells[cast[&quot;spell&quot;]].combat ) then</font>

<font color="#0000ff">         return &quot;|cFF909090&quot;,&quot;|r&quot;, false;
    else
        if ( cast[&quot;fail&quot;] ) then
            return &quot;|cFF00FF00&quot;,&quot;|r|cFFFF0000 (fail &quot;..cast[&quot;fail&quot;]..&quot;)|r&quot;, true;
        else
            return &quot;|cFF00FF00&quot;,&quot;|r&quot;,true;
        end
    end
end</font>

<font color="#0000ff"></font> 

<font color="#ff0000">未完</font>
</div>